/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{View as bt,ViewCollection as St,FocusCycler as Gt,ButtonView as mt}from'ckeditor5/src/ui';import{FocusTracker as _0x12e664,KeystrokeHandler as pt}from'ckeditor5/src/utils';import{icons as Yt}from'ckeditor5/src/core';import zt from'../commenteditor/commenteditor';export default class Et extends bt{constructor(_0x3c56ac,_0x4aa112={}){super(_0x3c56ac);const {t:t}=_0x3c56ac;this['editor']=new zt(_0x4aa112),this['keystrokes']=new pt(),this['focusTracker']=new _0x12e664(),this['set']('value',_0x4aa112['initialData']||''),this['set']('disabledSubmit',!0x1),this['set']('showButtons',!0x0),this['set']('placeholder',t('Reply...')),this['submitButtonView']=this['_createSubmitButton'](),this['cancelButtonView']=this['_createCancelButton'](),this['setTemplate']({'tag':'div','attributes':{'class':['ck-comment__input-wrapper']},'children':[{'tag':'div','attributes':{'class':['ck-comment__input-actions',this['bindTemplate']['if']('showButtons','ck-comment__input-actions--active')]},'children':[this['submitButtonView'],this['cancelButtonView']]}]}),this['keystrokes']['set']('Esc',(_0x4a6bfe,_0x3ad865)=>{this['cancelButtonView']['fire']('execute'),_0x3ad865();}),this['on']('submit',(_0x10d305,_0x288d33)=>{_0x288d33['length']>0xfde8?(alert(t({'string':'Comment\x20content\x20is\x20too\x20long.\x20Your\x20comment\x20has\x20%0\x20characters\x20but\x20the\x20limit\x20is\x20%1\x20characters.','id':'TOO_LONG_COMMENT_ALERT'},[_0x288d33['length'],0xfde8])),_0x10d305['stop']()):this['editor']['setData']('');},{'priority':'high'});}['render'](){super['render']();const {editor:_0x1195bb,element:_0x5c648d}=this;this['keystrokes']['listenTo'](_0x5c648d),this['focusTracker']['add'](_0x5c648d),this['_editorCreationPromise']=_0x1195bb['create']()['then'](()=>{_0x5c648d['insertBefore'](_0x1195bb['ui']['element'],_0x5c648d['firstChild']),_0x1195bb['model']['document']['on']('change',()=>this['value']=_0x1195bb['getData']()),_0x1195bb['bind']('placeholder')['to'](this),this['_initializeFocusCycling'](_0x1195bb),this['fire']('editorReady');});}['focus'](){this['editor']['focus']();}async['destroy'](){this['_isDestroyed']||(this['_isDestroyed']=!0x0,this['isRendered']&&(await this['_editorCreationPromise'],await this['editor']['destroy']()),await super['destroy']());}['_createSubmitButton'](){const _0x4544ec=new mt(this['locale']),{t:t}=this['locale'];return _0x4544ec['extendTemplate']({'attributes':{'class':['ck-comment__input-actions--submit']}}),_0x4544ec['label']=t('Submit'),_0x4544ec['icon']=Yt['check'],_0x4544ec['on']('execute',()=>{this['fire']('submit',this['value']);}),_0x4544ec['bind']('isEnabled')['to'](this,'value',this,'disabledSubmit',(_0xf6b131,_0x51e3a9)=>!_0x51e3a9&&!!_0xf6b131['trim']()),_0x4544ec;}['_createCancelButton'](){const _0x2ca9a7=new mt(this['locale']),{t:t}=this['locale'];return _0x2ca9a7['extendTemplate']({'attributes':{'class':['ck-comment__input-actions--cancel']}}),_0x2ca9a7['label']=t('Cancel'),_0x2ca9a7['icon']=Yt['cancel'],_0x2ca9a7['on']('execute',()=>{this['editor']['setData'](''),this['fire']('cancel');}),_0x2ca9a7;}['_initializeFocusCycling'](_0x2fe984){const _0x57f86b=this['focusTracker'],_0x356343=new St();[_0x2fe984['ui']['view'],this['submitButtonView'],this['cancelButtonView']]['forEach'](_0x57b799=>{_0x356343['add'](_0x57b799),_0x57f86b['add'](_0x57b799['element']);});const _0x45f615=new Gt({'focusables':_0x356343,'focusTracker':_0x57f86b});this['keystrokes']['set']('tab',(_0x187ff4,_0xeba78d)=>{_0x45f615['focusNext'](),_0xeba78d();},{'priority':'low'}),this['keystrokes']['set']('shift\x20+\x20tab',(_0x2fe8a2,_0x3913ad)=>{_0x45f615['focusPrevious'](),_0x3913ad();},{'priority':'low'});}}