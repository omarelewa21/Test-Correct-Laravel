/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x5b6e=['from','deactivateAll','add','isActive','collection','has','filter','annotationsuis-register-invalid-interface','destroy','set','push','annotationsuis-register-already-registered','type','context','plugins','annotationsuis-annotation-mismatch','activate','requires','listenTo','attach','activeAnnotations','hasActive','_assertAnnotationDoesNotBelongToMultipleUIs','activeUIs','_uisData','get','size','change:activeAnnotation','find','AnnotationsUIs','length','function','delete','_addActiveAnnotation','_uis','switchTo','setActiveAnnotation','detach','_setSelectedAnnotations','_activateAnnotation','deactivate','_visibleAnnotations','pluginName'];(function(_0x9aded0,_0x5b6e1b){const _0x1399fa=function(_0x295531){while(--_0x295531){_0x9aded0['push'](_0x9aded0['shift']());}};_0x1399fa(++_0x5b6e1b);}(_0x5b6e,0x8c));const _0x1399=function(_0x9aded0,_0x5b6e1b){_0x9aded0=_0x9aded0-0x0;let _0x1399fa=_0x5b6e[_0x9aded0];return _0x1399fa;};import{ContextPlugin as _0x19a17c}from'ckeditor5/src/core';import{CKEditorError as _0x38106e}from'ckeditor5/src/utils';import _0x19f427,{bindAnnotationCollections as _0x4eb783}from'./annotationcollection';import _0x285315 from'./annotations';export default class I extends _0x19a17c{static get[_0x1399('0x6')](){return[_0x285315];}static get[_0x1399('0x1f')](){return _0x1399('0x12');}constructor(_0x39e8f5){super(_0x39e8f5),this['activeUIs']=new Set(),this['_uis']=new Map(),this[_0x1399('0xd')]=new Map();}['init'](){const _0x334d52=this[_0x1399('0x2')][_0x1399('0x3')][_0x1399('0xe')](_0x285315);this[_0x1399('0x7')](_0x334d52,_0x1399('0x1c'),(_0x4448a2,_0x2415ed)=>{for(const _0x405fd8 of this[_0x1399('0xc')]){const _0x3bd9be=this['_uis'][_0x1399('0xe')](_0x405fd8);(0x0,this['_uisData'][_0x1399('0xe')](_0x405fd8)['filter'])(_0x2415ed)&&_0x3bd9be['setActiveAnnotation'](_0x2415ed);}}),this[_0x1399('0x7')](_0x334d52,'_deactivateAllAnnotations',()=>{for(const _0x3c8f80 of this[_0x1399('0xc')]){this[_0x1399('0x17')][_0x1399('0xe')](_0x3c8f80)['setActiveAnnotation'](null);}}),this['listenTo'](_0x334d52[_0x1399('0x1e')],'add',(_0x240b1d,_0x50101e)=>{this[_0x1399('0xb')](_0x50101e);});}[_0x1399('0xa')](){return this['activeUIs'][_0x1399('0xf')]>0x0;}[_0x1399('0x23')](_0x342495){return this['activeUIs']['has'](_0x342495);}[_0x1399('0x5')](_0x4436e4,_0x5057b4=()=>!0x0){const _0x561f4b=this[_0x1399('0x2')]['plugins'][_0x1399('0xe')](_0x285315);if(!this[_0x1399('0x17')][_0x1399('0x25')](_0x4436e4))throw new _0x38106e('annotationsuis-activate-missing-ui',this,{'uiName':_0x4436e4});this['isActive'](_0x4436e4)&&this['deactivate'](_0x4436e4),this[_0x1399('0xc')]['add'](_0x4436e4);const _0xe3ce5e=new _0x19f427(),_0x3a6746=_0x561f4b[_0x1399('0x1e')];_0x4eb783({'source':_0x3a6746,'target':_0xe3ce5e,'filter':_0x5057b4}),this[_0x1399('0xd')][_0x1399('0x29')](_0x4436e4,{'collection':_0xe3ce5e,'filter':_0x5057b4});const _0x484771=this[_0x1399('0x17')][_0x1399('0xe')](_0x4436e4);_0x484771[_0x1399('0x8')](_0xe3ce5e),this[_0x1399('0x7')](_0x484771,_0x1399('0x10'),(_0x295fd0,_0x504fe3,_0x4f2a4d,_0xec7f55)=>{_0xec7f55&&_0x561f4b['_removeActiveAnnotation'](_0xec7f55),_0x4f2a4d&&_0x561f4b[_0x1399('0x16')](_0x4f2a4d);});}['deactivate'](_0x1063b8){this[_0x1399('0xc')][_0x1399('0x15')](_0x1063b8);const _0x2361e6=this[_0x1399('0x17')]['get'](_0x1063b8);_0x2361e6[_0x1399('0x1a')](),this['stopListening'](_0x2361e6),this[_0x1399('0xd')][_0x1399('0xe')](_0x1063b8)[_0x1399('0x24')][_0x1399('0x28')](),this['_uisData'][_0x1399('0x15')](_0x1063b8);}[_0x1399('0x18')](_0x10bfc4){const _0x32369f=this[_0x1399('0x2')][_0x1399('0x3')][_0x1399('0xe')](_0x285315),_0x593d75=Array[_0x1399('0x20')](_0x32369f[_0x1399('0x9')])[0x0]||null;this['deactivateAll'](),this[_0x1399('0x5')](_0x10bfc4);const _0x17d9ef=this[_0x1399('0x17')]['get'](_0x10bfc4);_0x17d9ef[_0x1399('0x19')](_0x593d75),_0x17d9ef[_0x1399('0x1b')]&&_0x593d75&&_0x17d9ef[_0x1399('0x1b')]([_0x593d75]);}[_0x1399('0x21')](){for(const _0x1bfa92 of this[_0x1399('0xc')])this[_0x1399('0x1d')](_0x1bfa92);}['register'](_0x3bfea7,_0x2111f7){if(this[_0x1399('0x17')][_0x1399('0x25')](_0x3bfea7))throw new _0x38106e(_0x1399('0x0'));if(_0x1399('0x14')!=typeof _0x2111f7[_0x1399('0x8')]||_0x1399('0x14')!=typeof _0x2111f7['detach']||'function'!=typeof _0x2111f7[_0x1399('0x19')])throw new _0x38106e(_0x1399('0x27'),null);this[_0x1399('0x17')][_0x1399('0x29')](_0x3bfea7,_0x2111f7);}['refilterAnnotations'](){const _0x2bacc6=this[_0x1399('0x2')][_0x1399('0x3')]['get'](_0x285315)['collection'],_0x3a9497=new Map(),_0x67e443=Array[_0x1399('0x20')](this[_0x1399('0xc')]);for(const _0x230ce7 of this['activeUIs']){const _0x3e5f10=this[_0x1399('0xd')][_0x1399('0xe')](_0x230ce7)[_0x1399('0x24')];for(const _0x55113b of _0x3e5f10)_0x3a9497[_0x1399('0x29')](_0x55113b,_0x230ce7);}for(const _0x56f044 of _0x2bacc6){const _0x67c3a6=_0x3a9497['get'](_0x56f044);this[_0x1399('0xb')](_0x56f044);const _0x33ff1a=_0x67e443[_0x1399('0x11')](_0x2d0c4d=>this[_0x1399('0xd')]['get'](_0x2d0c4d)[_0x1399('0x26')](_0x56f044));_0x67c3a6!==_0x33ff1a&&(_0x67c3a6&&this[_0x1399('0xd')][_0x1399('0xe')](_0x67c3a6)[_0x1399('0x24')]['remove'](_0x56f044),_0x33ff1a&&this[_0x1399('0xd')]['get'](_0x33ff1a)[_0x1399('0x24')][_0x1399('0x22')](_0x56f044));}}[_0x1399('0x28')](){this[_0x1399('0x21')](),super[_0x1399('0x28')]();}['_assertAnnotationDoesNotBelongToMultipleUIs'](_0xd14a90){const _0x291396=[];for(const _0x1b3b2e of this[_0x1399('0xc')]){(0x0,this[_0x1399('0xd')][_0x1399('0xe')](_0x1b3b2e)[_0x1399('0x26')])(_0xd14a90)&&_0x291396[_0x1399('0x2a')](_0x1b3b2e);}if(_0x291396[_0x1399('0x13')]>0x1)throw new _0x38106e(_0x1399('0x4'),null,{'matchedUIs':_0x291396,'annotationType':_0xd14a90[_0x1399('0x1')]});}}