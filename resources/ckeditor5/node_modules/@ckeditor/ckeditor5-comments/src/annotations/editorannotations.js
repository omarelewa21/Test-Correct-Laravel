/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x7eca=['change:isFocused','view','getRanges','editor','selection','focusTracker','change:range','document','fire','add','innerView','from','uiUpdate','EditorAnnotations','element','isEqual','sort','getOrderedSelectedAnnotations','requires','plugins','blur','model','addSourceCollector','delete','set','map','isReadOnly','editing','annotation','_dataCollectors','_editorAnnotationsData','containsRange','editorannotations-invalid-source-callback','get','cancel','has','hasDomSelection','pluginName','update','range','listenTo','refreshSelectedViews','remove'];(function(_0x57e516,_0x7ecae0){const _0x11f7ff=function(_0x5202c9){while(--_0x5202c9){_0x57e516['push'](_0x57e516['shift']());}};_0x11f7ff(++_0x7ecae0);}(_0x7eca,0x7b));const _0x11f7=function(_0x57e516,_0x7ecae0){_0x57e516=_0x57e516-0x0;let _0x11f7ff=_0x7eca[_0x57e516];return _0x11f7ff;};import{Plugin as _0x5a9420}from'ckeditor5/src/core';import{CKEditorError as _0x334e9a}from'ckeditor5/src/utils';import{debounce as _0x5b42b1}from'lodash-es';import _0x2a978f from'./annotations';export default class k extends _0x5a9420{static get[_0x11f7('0x18')](){return[_0x2a978f];}static get[_0x11f7('0x0')](){return _0x11f7('0x13');}constructor(_0x52ee70){super(_0x52ee70),this[_0x11f7('0x23')]=new Set();}['init'](){const _0x16da2e=this['editor'],_0x292e1e=_0x16da2e[_0x11f7('0x19')][_0x11f7('0x27')](_0x2a978f),_0x4b7472=_0x16da2e[_0x11f7('0x1b')]['document'][_0x11f7('0xa')],_0x2f5237=_0x5b42b1(()=>this[_0x11f7('0x4')](),0xa);_0x4b7472['on'](_0x11f7('0xc'),(_0x1e0430,_0x2ce74d)=>{_0x2ce74d['directChange']&&(_0x2f5237[_0x11f7('0x28')](),this[_0x11f7('0x4')]());}),this[_0x11f7('0x3')](_0x16da2e[_0x11f7('0x21')][_0x11f7('0x7')][_0x11f7('0xd')],_0x11f7('0x6'),(_0x41481f,_0x49e47e,_0x56917c)=>{_0x56917c&&_0x2f5237();}),this[_0x11f7('0x3')](_0x16da2e['ui'][_0x11f7('0xb')],_0x11f7('0x6'),(_0x26c2f6,_0x13ec77,_0x3dc960)=>{_0x3dc960||_0x16da2e[_0x11f7('0x20')]||this[_0x11f7('0xe')](_0x11f7('0x1a'),{'isAnnotationTracked':_0x3ec2dd=>this['_editorAnnotationsData'][_0x11f7('0x29')](_0x3ec2dd[_0x11f7('0x10')])});}),this[_0x11f7('0x3')](this[_0x11f7('0x9')]['ui'],_0x11f7('0x1'),()=>this[_0x11f7('0xe')](_0x11f7('0x12')));const _0x3fe0b4=new Set();this[_0x11f7('0x3')](_0x292e1e['collection'],_0x11f7('0xf'),(_0xa7b415,_0x43f5a5)=>{for(const _0x5613bf of this['_editorAnnotationsData']['keys']())if(_0x5613bf===_0x43f5a5[_0x11f7('0x10')]){_0x16da2e['ui'][_0x11f7('0xb')]['add'](_0x43f5a5['view'][_0x11f7('0x14')]),_0x3fe0b4[_0x11f7('0xf')](_0x43f5a5['view']);break;}}),this[_0x11f7('0x3')](_0x292e1e['collection'],_0x11f7('0x5'),(_0x413679,_0x43d9b1)=>{_0x3fe0b4[_0x11f7('0x29')](_0x43d9b1[_0x11f7('0x7')])&&(_0x16da2e['ui'][_0x11f7('0xb')][_0x11f7('0x5')](_0x43d9b1[_0x11f7('0x7')][_0x11f7('0x14')]),_0x3fe0b4[_0x11f7('0x1d')](_0x43d9b1[_0x11f7('0x7')]));});}[_0x11f7('0x2a')](){return this['editor']['editing'][_0x11f7('0x7')][_0x11f7('0x2a')];}[_0x11f7('0x1c')](_0x2ae256){if('function'!=typeof _0x2ae256)throw new _0x334e9a(_0x11f7('0x26'));this['_dataCollectors'][_0x11f7('0xf')](_0x2ae256);}[_0x11f7('0x4')](){this['fire']('refresh');}[_0x11f7('0x17')]({activeAnnotation:_0x34671a,annotations:_0x5b3322}){const _0x335dc3=[],_0x568486=this['editor'][_0x11f7('0x1b')]['document'][_0x11f7('0xa')],_0x16ea55=Array[_0x11f7('0x11')](_0x568486[_0x11f7('0x8')]());for(const [_0x5266c0,_0x189d4d]of this[_0x11f7('0x24')]){const _0x499b37=_0x491c50(_0x189d4d),_0x5b6a7d=_0x5b3322['getByInnerView'](_0x5266c0);_0x499b37&&_0x5b6a7d&&_0x335dc3['push']({'annotation':_0x5b6a7d,'range':_0x499b37});}function _0x491c50(_0x369dae){for(const _0x498b77 of _0x369dae)for(const _0x5017f0 of _0x16ea55)if(_0x498b77['containsRange'](_0x5017f0,!_0x568486['isCollapsed']))return _0x498b77;return null;}return _0x335dc3[_0x11f7('0x16')]((_0x4b75d8,_0x5a3a17)=>{const _0x20413e=_0x4b75d8['range'],_0x1f5e3d=_0x5a3a17[_0x11f7('0x2')];if(!_0x20413e[_0x11f7('0x15')](_0x1f5e3d)){if(_0x20413e[_0x11f7('0x25')](_0x1f5e3d,!0x0))return 0x1;if(_0x1f5e3d[_0x11f7('0x25')](_0x20413e,!0x0))return-0x1;}return _0x4b75d8[_0x11f7('0x22')]==_0x34671a?-0x1:_0x5a3a17['annotation']==_0x34671a?0x1:0x0;})[_0x11f7('0x1f')](_0x405581=>_0x405581[_0x11f7('0x22')]);}get[_0x11f7('0x24')](){const _0x26a1f5=new Map();for(const _0x32a72c of Array['from'](this[_0x11f7('0x23')]))for(const [_0x2efc1f,_0xbda767]of _0x32a72c())_0x26a1f5[_0x11f7('0x1e')](_0x2efc1f,_0xbda767);return _0x26a1f5;}}