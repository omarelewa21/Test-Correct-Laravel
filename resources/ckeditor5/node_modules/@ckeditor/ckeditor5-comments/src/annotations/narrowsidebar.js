/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x22c3=['isAttached','plugins','content','hasDomSelection','_detachFromContainer','Sidebar','init','_hideBalloon','preventClosingBalloon','EditorAnnotations','ck-sidebar--narrow','number','removeEventListener','northArrowSouth','_setSelectedAnnotations','resize','stopListening','keyCode','_destroyEditorAnnotationsIntegration','stop','editors','refreshPositioning','_attachListeners','_updateBalloonPosition','activeAnnotation','_domEmitter','target','mousedown','_annotationToNarrowView','balloonPanelView','blur','register','off','getByView','context','change:height','detach','isVisible','pluginName','refresh','narrowSidebar','Esc','listenTo','length','set','_throttledRefreshPositioning','preventDefault','first','set:container','attach','clear','stopPropagation','low','keydown','requires','ready','addEventListener','pin','change:container','high','type','focus','defaultPositions','esc','getSidebarItemView','setActiveAnnotation','_showBalloon','_annotations','cancel','bind','values','destroy','view','annotationType','get','contains','_selectedAnnotations','_detachListeners','element','remove','add','_integrateWithEditorAnnotations','northArrowSouthWest','unpin','delete','has','_editorAnnotations','bodyCollection','_refreshPositioning','_attachToContainer','southArrowNorthWest','locale','rearrange','southArrowNorthEast','_manuallyClosedAnnotationViews','narrowsidebar-attach-already-attached'];(function(_0x152738,_0x22c313){const _0xa3fa0a=function(_0x5a2e8b){while(--_0x5a2e8b){_0x152738['push'](_0x152738['shift']());}};_0xa3fa0a(++_0x22c313);}(_0x22c3,0xbc));const _0xa3fa=function(_0x152738,_0x22c313){_0x152738=_0x152738-0x0;let _0xa3fa0a=_0x22c3[_0x152738];return _0xa3fa0a;};import{ContextPlugin as _0xce22ef}from'ckeditor5/src/core';import _0x3eab28 from'./annotationsuis';import _0xdcc9b0 from'./sidebar';import _0x247ca2 from'./view/annotationcounterbuttonview';import{BalloonPanelView as _0x1c66bc,BodyCollection as _0x561f52}from'ckeditor5/src/ui';import{CKEditorError as _0x20a550,DomEmitterMixin as _0x3bc5de,keyCodes as _0x506443,Collection as _0x45798c}from'ckeditor5/src/utils';import'../../theme/sidebar-narrow.css';import{throttle as _0x5471ef}from'lodash-es';export default class s extends _0xce22ef{static get[_0xa3fa('0x3a')](){return[_0xdcc9b0,_0x3eab28];}static get[_0xa3fa('0x2a')](){return'NarrowSidebar';}constructor(_0x4b3e6d){super(_0x4b3e6d),this[_0xa3fa('0x4')]=!0x1,this['_manuallyClosedAnnotationViews']=new Set(),this[_0xa3fa('0x1d')]=Object['create'](_0x3bc5de),this[_0xa3fa('0x20')]=new Map(),this[_0xa3fa('0x30')](_0xa3fa('0x1c'),null),this[_0xa3fa('0x47')]=null,this[_0xa3fa('0x50')]=[],this['_editorAnnotations']=new _0x45798c(),this[_0xa3fa('0x31')]=_0x5471ef(()=>{this[_0xa3fa('0x5c')]();},0x190,{'leading':!0x1});}[_0xa3fa('0xa')](){this[_0xa3fa('0x26')][_0xa3fa('0x5')][_0xa3fa('0x4e')](_0x3eab28)[_0xa3fa('0x23')](_0xa3fa('0x2c'),this),this[_0xa3fa('0x5b')]=new _0x561f52(this[_0xa3fa('0x26')][_0xa3fa('0x5f')]),this[_0xa3fa('0x21')]=new _0x1c66bc(this[_0xa3fa('0x26')][_0xa3fa('0x5f')]),this['bodyCollection']['attachToDom'](),this['bodyCollection']['add'](this[_0xa3fa('0x21')]);}[_0xa3fa('0x35')](_0x163b9c){this['_annotations']=_0x163b9c;const _0x2176fc=this[_0xa3fa('0x26')]['plugins'][_0xa3fa('0x4e')](_0xdcc9b0),_0x15c5ef=this[_0xa3fa('0x21')];if(_0x2176fc[_0xa3fa('0x47')]=_0x163b9c,this[_0xa3fa('0x4')])throw new _0x20a550(_0xa3fa('0x3'),this);this[_0xa3fa('0x4')]=!0x0,this['listenTo'](_0x2176fc,_0xa3fa('0x34'),()=>{this[_0xa3fa('0x28')](),this['listenTo'](_0x2176fc,_0xa3fa('0x3e'),_0x4344dd=>{_0x4344dd[_0xa3fa('0x24')](),this[_0xa3fa('0x35')](_0x163b9c);});}),_0x2176fc[_0xa3fa('0x5d')]({'viewClass':_0xa3fa('0xe'),'spaceBetweenItems':0x5});const _0x5d6d22=_0x1adfed=>{const _0x58905f=new _0x247ca2(this['context'][_0xa3fa('0x5f')]);_0x2176fc['addAnnotation'](_0x1adfed,_0x58905f),this['_annotationToNarrowView'][_0xa3fa('0x30')](_0x1adfed,_0x58905f),_0x58905f[_0xa3fa('0x49')]('isDirty',_0xa3fa('0x4d'),_0xa3fa('0xf'))['to'](_0x1adfed['view'],'isDirty',_0xa3fa('0x40'),_0xa3fa('0x2f')),_0x58905f['on']('execute',()=>{this[_0xa3fa('0x2')][_0xa3fa('0x36')](),_0x15c5ef[_0xa3fa('0x6')][_0xa3fa('0x33')]!==_0x1adfed[_0xa3fa('0x4c')]?(this[_0xa3fa('0x46')](_0x1adfed),_0x1adfed[_0xa3fa('0x4c')][_0xa3fa('0x52')]['focus'](),this['setActiveAnnotation'](_0x1adfed)):this[_0xa3fa('0x45')](null);});};for(const _0x166106 of _0x163b9c)_0x5d6d22(_0x166106);this['listenTo'](_0x163b9c,'add',(_0x105519,_0x304e7a)=>{_0x5d6d22(_0x304e7a);}),this[_0xa3fa('0x2e')](_0x163b9c,_0xa3fa('0x53'),(_0x72d76,_0x3370e0,_0x558318)=>{this[_0xa3fa('0x20')]['get'](_0x3370e0)[_0xa3fa('0x4b')](),this['_annotationToNarrowView'][_0xa3fa('0x58')](_0x3370e0),_0x2176fc[_0xa3fa('0x0')]({'removedAnnotation':_0x3370e0,'previousAnnotation':_0x163b9c[_0xa3fa('0x4e')](_0x558318-0x1),'nextAnnotation':_0x163b9c[_0xa3fa('0x4e')](_0x558318+0x1)}),_0x3370e0===this[_0xa3fa('0x1c')]&&this[_0xa3fa('0x45')](null);},{'priority':_0xa3fa('0x38')}),this['listenTo'](_0x163b9c,_0xa3fa('0x41'),(_0x43bde2,_0x511568)=>{this[_0xa3fa('0x45')](_0x511568);}),this[_0xa3fa('0x2e')](_0x163b9c,'blur',()=>{this[_0xa3fa('0x45')](null);}),this[_0xa3fa('0x1d')][_0xa3fa('0x2e')](document,_0xa3fa('0x39'),(_0x277001,_0x38a6d0)=>{_0x38a6d0[_0xa3fa('0x15')]===_0x506443[_0xa3fa('0x43')]&&_0x15c5ef[_0xa3fa('0x29')]&&(this[_0xa3fa('0x2')][_0xa3fa('0x54')](_0x15c5ef[_0xa3fa('0x6')][_0xa3fa('0x33')]),this[_0xa3fa('0xb')](),_0x38a6d0[_0xa3fa('0x37')](),_0x38a6d0[_0xa3fa('0x32')]());}),this[_0xa3fa('0x1d')][_0xa3fa('0x2e')](document,_0xa3fa('0x1f'),(_0x401ab4,_0x71952f)=>{const _0x33f0cb=_0x71952f[_0xa3fa('0x1e')];_0x15c5ef[_0xa3fa('0x29')]&&_0x15c5ef[_0xa3fa('0x52')]['contains'](_0x33f0cb)||_0x2176fc[_0xa3fa('0x4c')][_0xa3fa('0x52')]['contains'](_0x33f0cb)||_0x401ab4[_0xa3fa('0xc')]||(this[_0xa3fa('0x2')][_0xa3fa('0x36')](),this['_hideBalloon'](),this[_0xa3fa('0x45')](null));});const _0x150498=this['context']['editors']?this['context'][_0xa3fa('0x18')]:new _0x45798c([this[_0xa3fa('0x26')]]);for(const _0x559692 of _0x150498)this[_0xa3fa('0x55')](_0x559692);this[_0xa3fa('0x2e')](_0x150498,_0xa3fa('0x54'),(_0x46947d,_0x4e4207)=>{this[_0xa3fa('0x2e')](_0x4e4207,_0xa3fa('0x3b'),()=>{this['_integrateWithEditorAnnotations'](_0x4e4207);});}),this[_0xa3fa('0x2e')](_0x150498,'remove',(_0x5a2c97,_0x52caf0)=>{_0x52caf0[_0xa3fa('0x5')][_0xa3fa('0x59')](_0xa3fa('0xd'))&&this[_0xa3fa('0x16')](_0x52caf0[_0xa3fa('0x5')][_0xa3fa('0x4e')](_0xa3fa('0xd')));}),window[_0xa3fa('0x3c')](_0xa3fa('0x13'),this[_0xa3fa('0x31')]),this[_0xa3fa('0x5c')]();}[_0xa3fa('0x45')](_0x4df7a8){if(_0x4df7a8===this[_0xa3fa('0x1c')])return;const _0x18dd5a=this[_0xa3fa('0x26')]['plugins']['get'](_0xa3fa('0x9'));if(_0x18dd5a[_0xa3fa('0x2b')]({'blurredAnnotation':this[_0xa3fa('0x1c')],'activatedAnnotation':_0x4df7a8,'disableAnimationOnActivatedAnnotation':!0x0}),_0x4df7a8)_0x18dd5a[_0xa3fa('0x44')](_0x4df7a8)?this['_showBalloon'](_0x4df7a8):this['_hideBalloon']();else this[_0xa3fa('0xb')]();this['activeAnnotation']=_0x4df7a8;}[_0xa3fa('0x28')](){if(!this[_0xa3fa('0x4')])throw new _0x20a550('narrowsidebar-detach-not-attached',this);this['setActiveAnnotation'](null);const _0x341020=this[_0xa3fa('0x26')][_0xa3fa('0x5')][_0xa3fa('0x4e')]('Sidebar');this[_0xa3fa('0xb')](),Array['from'](this[_0xa3fa('0x20')][_0xa3fa('0x4a')](),_0x458d31=>_0x458d31['destroy']()),this[_0xa3fa('0x20')][_0xa3fa('0x36')](),_0x341020[_0xa3fa('0x8')](this[_0xa3fa('0x47')]),this[_0xa3fa('0x14')](),this[_0xa3fa('0x1d')][_0xa3fa('0x14')](),this[_0xa3fa('0x14')](this[_0xa3fa('0x26')]['editors']);for(const _0x63e327 of Array['from'](this[_0xa3fa('0x5a')]))this['_destroyEditorAnnotationsIntegration'](_0x63e327);window[_0xa3fa('0x10')](_0xa3fa('0x13'),this['_throttledRefreshPositioning']),this[_0xa3fa('0x31')][_0xa3fa('0x48')](),this[_0xa3fa('0x50')]=[],this['isAttached']=!0x1,this['_annotations']=null;}[_0xa3fa('0x4b')](){this[_0xa3fa('0x4')]&&this['detach'](),this[_0xa3fa('0x5b')]['detachFromDom']();}[_0xa3fa('0x55')](_0x38a283){const _0x34e3e8=_0x38a283['plugins'][_0xa3fa('0x4e')](_0xa3fa('0xd')),_0x4fb254=this[_0xa3fa('0x26')]['plugins']['get'](_0xdcc9b0),_0xdc292b=this['_annotations'],_0x2f897d=this['balloonPanelView'],_0x376133=()=>{const _0x20abe6=_0x34e3e8['getOrderedSelectedAnnotations']({'activeAnnotation':this['activeAnnotation'],'annotations':this[_0xa3fa('0x47')]});this[_0xa3fa('0x12')](_0x20abe6),this['setActiveAnnotation'](_0x20abe6[0x0]||null);};this[_0xa3fa('0x2e')](_0x34e3e8,_0xa3fa('0x2b'),_0x376133),this[_0xa3fa('0x2e')](_0x34e3e8,_0xa3fa('0x22'),(_0x242c7c,{isAnnotationTracked:_0x3078fb})=>{this[_0xa3fa('0x1c')]&&_0x3078fb(this[_0xa3fa('0x1c')])&&(this[_0xa3fa('0x12')]([]),this[_0xa3fa('0x45')](null));}),this[_0xa3fa('0x2e')](_0x34e3e8,'uiUpdate',()=>{this[_0xa3fa('0x31')]();}),this[_0xa3fa('0x2e')](_0xdc292b,'blur',_0x154f6b=>{_0x34e3e8[_0xa3fa('0x7')]()&&_0x154f6b[_0xa3fa('0x17')]();},{'priority':_0xa3fa('0x3f')}),this[_0xa3fa('0x1d')]['listenTo'](document,_0xa3fa('0x1f'),(_0x53f636,_0x235d60)=>{const _0x5dfa1b=_0x235d60[_0xa3fa('0x1e')];_0x2f897d[_0xa3fa('0x29')]&&_0x2f897d['element']['contains'](_0x5dfa1b)||_0x4fb254[_0xa3fa('0x4c')]['element'][_0xa3fa('0x4f')](_0x5dfa1b)||this[_0xa3fa('0x1c')]&&_0x34e3e8[_0xa3fa('0x7')]()&&(_0x376133(),_0x53f636[_0xa3fa('0xc')]=!0x0);},{'priority':_0xa3fa('0x3f')}),this[_0xa3fa('0x5a')]['add'](_0x34e3e8);}[_0xa3fa('0x16')](_0x1b0005){_0x1b0005&&(this[_0xa3fa('0x14')](_0x1b0005),this[_0xa3fa('0x5a')][_0xa3fa('0x53')](_0x1b0005));}[_0xa3fa('0x12')](_0x1a3e3c){for(const _0x5a6307 of this['_selectedAnnotations'])_0x1a3e3c['includes'](_0x5a6307)||this[_0xa3fa('0x2')]['delete'](_0x5a6307['view']);this[_0xa3fa('0x50')]=_0x1a3e3c;}[_0xa3fa('0x5c')](){const _0x38f839=this[_0xa3fa('0x21')];this[_0xa3fa('0x47')][_0xa3fa('0x19')](),_0x38f839[_0xa3fa('0x29')]&&this[_0xa3fa('0x1b')]();}[_0xa3fa('0x46')](_0x3e8512){if(this[_0xa3fa('0x2')][_0xa3fa('0x59')](_0x3e8512[_0xa3fa('0x4c')]))return;const _0x4a088c=this[_0xa3fa('0x21')][_0xa3fa('0x6')][_0xa3fa('0x33')];_0x4a088c!==_0x3e8512[_0xa3fa('0x4c')]?(_0x4a088c&&this[_0xa3fa('0x51')](_0x4a088c),this['_attachListeners'](_0x3e8512[_0xa3fa('0x4c')]),this['balloonPanelView']['content']['clear'](),this[_0xa3fa('0x21')][_0xa3fa('0x6')][_0xa3fa('0x54')](_0x3e8512[_0xa3fa('0x4c')]),this[_0xa3fa('0x1b')]()):this['_updateBalloonPosition']();}['_updateBalloonPosition'](){const _0x298bf4=this[_0xa3fa('0x21')]['content'][_0xa3fa('0x33')],_0x5446f8=this['_annotations'][_0xa3fa('0x25')](_0x298bf4);if(!this[_0xa3fa('0x20')][_0xa3fa('0x59')](_0x5446f8))return;const _0x45b66e=this[_0xa3fa('0x20')][_0xa3fa('0x4e')](_0x5446f8)['element'],_0x32f2fa=function(){const _0x5c8749=_0x1c66bc[_0xa3fa('0x42')];return[_0x5c8749[_0xa3fa('0x1')],_0x5c8749['northArrowSouthEast'],_0x5c8749['southArrowNorth'],_0x5c8749[_0xa3fa('0x11')],_0x5c8749[_0xa3fa('0x5e')],_0x5c8749[_0xa3fa('0x56')]];}();this[_0xa3fa('0x21')][_0xa3fa('0x3d')]({'target':_0x45b66e,'positions':_0x32f2fa});}[_0xa3fa('0xb')](){const _0x2cd591=this[_0xa3fa('0x21')],_0x5b034a=_0x2cd591[_0xa3fa('0x6')][_0xa3fa('0x33')];_0x5b034a&&(this[_0xa3fa('0x51')](_0x5b034a),_0x2cd591[_0xa3fa('0x57')](),_0x2cd591[_0xa3fa('0x6')][_0xa3fa('0x36')]());}[_0xa3fa('0x1a')](_0x4a317e){this[_0xa3fa('0x2e')](_0x4a317e,_0xa3fa('0x27'),()=>this[_0xa3fa('0x1b')]()),this[_0xa3fa('0x2e')](_0x4a317e,_0xa3fa('0x2d'),(_0x8b3a0c,_0x11476a)=>{this[_0xa3fa('0x2')][_0xa3fa('0x54')](_0x4a317e),this['_hideBalloon'](),_0x11476a();});}[_0xa3fa('0x51')](_0x4915a0){this[_0xa3fa('0x14')](_0x4915a0);}}